<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Marketing Dashboard 예시</title>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f7fa; }
    .filters { display: flex; gap: 10px; margin-bottom: 20px; }
    .filters select { padding: 5px; }
    .charts { display: flex; gap: 20px; margin-bottom: 20px; }
    .chart-container { background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); flex: 1; }
    table { width: 100%; border-collapse: collapse; background: #fff; }
    th, td { padding: 8px; text-align: center; border-bottom: 1px solid #ddd; }
    th { background: #eef1f7; }
    .report-section { margin-top: 30px; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .report-section button { padding: 8px 12px; border: none; background: #3b82f6; color: #fff; border-radius: 4px; cursor: pointer; }
    .report-section textarea { width: 100%; height: 80px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>마케팅 데이터 대시보드 예시</h1>
  <div class="filters">
    <select id="clientFilter">
      <option value="All">전체 클라이언트</option>
      <option value="Client A">Client A</option>
      <option value="Client B">Client B</option>
      <option value="Client C">Client C</option>
    </select>
    <select id="mediaFilter">
      <option value="All">전체 매체</option>
      <option value="Google">Google Ads</option>
      <option value="Meta">Meta Ads</option>
      <option value="Naver">Naver SA</option>
    </select>
    <select id="dateFilter">
      <option value="7">지난 7일</option>
      <option value="30">지난 30일</option>
      <option value="90">지난 90일</option>
    </select>
  </div>

  <div class="charts">
    <div class="chart-container">
      <canvas id="barChart"></canvas>
    </div>
    <div class="chart-container">
      <canvas id="lineChart"></canvas>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>클라이언트</th>
        <th>매체</th>
        <th>광고비(₩)</th>
        <th>ROAS(%)</th>
        <th>CTR(%)</th>
        <th>전환수</th>
      </tr>
    </thead>
    <tbody id="dataTable">
      <!-- JS로 삽입 -->
    </tbody>
  </table>

  <div class="report-section">
    <h2>외부용 보고서 생성</h2>
    <button id="generateReport">보고서 링크 생성</button>
    <textarea id="insights" placeholder="인사이트를 입력하세요..."></textarea>
    <div id="reportLink"></div>
  </div>

  <script>
    // 가상 데이터 샘플
    const sampleData = [
      { client: 'Client A', media: 'Google', spend: 500000, roas: 120, ctr: 2.5, conv: 300, date: '2025-07-28' },
      { client: 'Client A', media: 'Meta', spend: 350000, roas: 150, ctr: 3.1, conv: 280, date: '2025-07-28' },
      { client: 'Client B', media: 'Naver', spend: 450000, roas: 110, ctr: 1.9, conv: 250, date: '2025-07-28' },
      { client: 'Client C', media: 'Google', spend: 300000, roas: 130, ctr: 2.2, conv: 200, date: '2025-07-28' },
      // ... 더미 데이터 추가 가능
    ];

    // 필터 이벤트 핸들러
    document.querySelectorAll('.filters select').forEach(el => {
      el.addEventListener('change', renderDashboard);
    });
    document.getElementById('generateReport').addEventListener('click', () => {
      const link = document.createElement('a');
      link.href = '#';
      link.textContent = 'https://your-domain.com/report/2025-08-06';
      link.target = '_blank';
      document.getElementById('reportLink').innerHTML = '';
      document.getElementById('reportLink').appendChild(link);
    });

    let barChart, lineChart;
    function renderDashboard() {
      const client = document.getElementById('clientFilter').value;
      const media = document.getElementById('mediaFilter').value;
      // 날짜 필터는 예시상 무시

      // 필터 적용 데이터
      const filtered = sampleData.filter(d =>
        (client === 'All' || d.client === client) &&
        (media === 'All' || d.media === media)
      );

      // 테이블 렌더링
      const tbody = document.getElementById('dataTable');
      tbody.innerHTML = '';
      filtered.forEach(d => {
        const tr = document.createElement('tr');
        Object.values(d).slice(0,5).forEach((v,i) => {
          const td = document.createElement('td');
          td.textContent = i < 2 ? v : (typeof v === 'number' ? v.toLocaleString() : v);
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });

      // 차트 데이터 준비
      const labels = [...new Set(filtered.map(d => d.media))];
      const spendData = labels.map(m => filtered.filter(d=>d.media===m).reduce((sum,d)=>sum+d.spend,0));
      const roasData = labels.map(m => {
        const arr = filtered.filter(d=>d.media===m).map(d=>d.roas);
        return arr.length? (arr.reduce((a,b)=>a+b,0)/arr.length).toFixed(1) : 0;
      });

      // 막대차트 렌더
      if (barChart) barChart.destroy();
      barChart = new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: { labels, datasets: [{ label: 'Spend(₩)', data: spendData }] }
      });

      // 꺾은선차트 렌더
      if (lineChart) lineChart.destroy();
      lineChart = new Chart(document.getElementById('lineChart'), {
        type: 'line',
        data: { labels, datasets: [{ label: 'Average ROAS(%)', data: roasData, fill: false }] }
      });
    }

    // 최초 렌더
    renderDashboard();
  </script>
</body>
</html>
