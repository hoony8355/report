<!DOCTYPE html>
<html lang='ko'>
<head>
  <meta charset='UTF-8'/>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'/>
  <title>ì„¸ê·¸ë¨¼íŠ¸ë³„ ë¦¬ë“œ ì„±ê³¼ ë¦¬í¬íŠ¸</title>
  <script src='https://cdn.jsdelivr.net/npm/chart.js'></script>
  <link rel='stylesheet' href='https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css'/>
  <script src='https://code.jquery.com/jquery-3.6.0.min.js'></script>
  <script src='https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js'></script>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin:20px; background:#f4f6f8; }
    h1 { margin-bottom:10px; }
    .period { font-size:.9rem; color:#555; margin-bottom:20px; }
    .nav { margin-bottom:20px; }
    .nav button { padding:8px 14px; margin-right:8px; border:1px solid #ccc; border-radius:4px; background:#fff; cursor:pointer; }
    .nav button.active { background:#3b82f6; color:#fff; border-color:#3b82f6; }
    .section { display:none; background:#fff; padding:20px; margin-bottom:30px; border-radius:6px; box-shadow:0 1px 3px rgba(0,0,0,0.1); }
    .charts { display:flex; gap:20px; margin-bottom:20px; }
    .chart-container { flex:1; }
    table.dataTable { width:100% !important; margin-bottom:20px; }
    textarea.insight { width:100%; height:100px; padding:10px; border:1px solid #ccc; border-radius:4px; }
    .dt-right { text-align:right; }
  </style>
</head>
<body>
  <h1>ì„¸ê·¸ë¨¼íŠ¸ë³„ ë¦¬ë“œ ì„±ê³¼ ë¦¬í¬íŠ¸</h1>
  <div class='period'>ê¸°ê°„: 2025-07-31 ~ 2025-08-05</div>

  <div class="nav">
    <button data-target="ì „ì²´" class="active">ì „ì²´</button>
    <button data-target="ì˜ì—…íŒ€ì¥">ì˜ì—…íŒ€ì¥</button>
    <button data-target="ë§ˆì¼€íŒ…íŒ€ì¥">ë§ˆì¼€íŒ…íŒ€ì¥</button>
    <button data-target="ëŒ€í‘œ">ëŒ€í‘œ</button>
  </div>

  <div id='sections'></div>

  <script>
    const segments = ['ì˜ì—…íŒ€ì¥','ë§ˆì¼€íŒ…íŒ€ì¥','ëŒ€í‘œ'];
    const channels = ['ë¦¬ë©¤ë²„','êµ¬ê¸€'];

    // ê°€ìƒì˜ ë°ì´í„° (CPA 45k ~ 75k ë°˜ì˜)
    const sampleData = {
      'ì˜ì—…íŒ€ì¥': {
        'ë¦¬ë©¤ë²„': [
          {period:'W1', spend:200000, impr:4000, clicks:320, conv:4},
          {period:'W2', spend:250000, impr:5000, clicks:360, conv:5},
          {period:'W3', spend:300000, impr:5500, clicks:380, conv:6}
        ],
        'êµ¬ê¸€': [
          {period:'W1', spend:180000, impr:8000, clicks:350, conv:3},
          {period:'W2', spend:200000, impr:8500, clicks:370, conv:3},
          {period:'W3', spend:220000, impr:9000, clicks:400, conv:4}
        ]
      },
      'ë§ˆì¼€íŒ…íŒ€ì¥': {
        'ë¦¬ë©¤ë²„': [
          {period:'W1', spend:180000, impr:3500, clicks:280, conv:3},
          {period:'W2', spend:200000, impr:4000, clicks:300, conv:4},
          {period:'W3', spend:220000, impr:4200, clicks:320, conv:4}
        ],
        'êµ¬ê¸€': [
          {period:'W1', spend:150000, impr:7000, clicks:320, conv:2},
          {period:'W2', spend:170000, impr:7200, clicks:340, conv:2},
          {period:'W3', spend:180000, impr:7400, clicks:350, conv:3}
        ]
      },
      'ëŒ€í‘œ': {
        'ë¦¬ë©¤ë²„': [
          {period:'W1', spend:220000, impr:3000, clicks:200, conv:4},
          {period:'W2', spend:250000, impr:3200, clicks:220, conv:5},
          {period:'W3', spend:280000, impr:3400, clicks:230, conv:6}
        ],
        'êµ¬ê¸€': [
          {period:'W1', spend:200000, impr:6000, clicks:250, conv:3},
          {period:'W2', spend:220000, impr:6200, clicks:270, conv:3},
          {period:'W3', spend:240000, impr:6400, clicks:280, conv:3}
        ]
      }
    };

    // í†µí•©ì§€í‘œ ìƒì„±
    function makeOverall(){
      const overall = {'ë¦¬ë©¤ë²„':[], 'êµ¬ê¸€':[]};
      ['ë¦¬ë©¤ë²„','êµ¬ê¸€'].forEach(ch=>{
        for(let i=0;i<3;i++){
          const segs = segments.map(s=>sampleData[s][ch][i]);
          const merged = {
            period: sampleData['ì˜ì—…íŒ€ì¥'][ch][i].period,
            spend: segs.reduce((a,b)=>a+b.spend,0),
            impr: segs.reduce((a,b)=>a+b.impr,0),
            clicks: segs.reduce((a,b)=>a+b.clicks,0),
            conv: segs.reduce((a,b)=>a+b.conv,0)
          };
          overall[ch].push(merged);
        }
      });
      return overall;
    }
    sampleData['ì „ì²´'] = makeOverall();

    // ì§€í‘œ ê³„ì‚°
    function enrich(d){
      d.cpa = d.conv ? Math.round(d.spend/d.conv) : 0;
      d.ctr = d.impr ? +(d.clicks/d.impr*100).toFixed(2) : 0;
      d.cvr = d.clicks ? +(d.conv/d.clicks*100).toFixed(2) : 0;
      return d;
    }
    Object.keys(sampleData).forEach(seg=>{
      channels.forEach(ch=>{
        sampleData[seg][ch] = sampleData[seg][ch].map(enrich);
      });
    });

    // ì¸ì‚¬ì´íŠ¸
    function makeInsight(seg){
      if(seg==='ì „ì²´'){
        return `ë¦¬ë©¤ë²„ëŠ” í‰ê·  CPA 49,000ì› ìˆ˜ì¤€ìœ¼ë¡œ ëª©í‘œ CPA 50,000ì›ì„ ì¶©ì¡±í•˜ë©° ì•ˆì •ì ì¸ ì„±ê³¼ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.  
êµ¬ê¸€ì€ CPA 65,000ì› ì´ìƒìœ¼ë¡œ ë‹¤ì†Œ ë¹„íš¨ìœ¨ì ì´ì—ˆìœ¼ë‚˜, ì´ˆê¸° í•™ìŠµ ë° ì¸ì§€ë„ í™•ëŒ€ì— ê¸°ì—¬í–ˆìŠµë‹ˆë‹¤.  
ğŸ‘‰ ê²°ë¡ ì ìœ¼ë¡œ ë¦¬ë“œ í’ˆì§ˆê³¼ íš¨ìœ¨ ëª¨ë‘ ë¦¬ë©¤ë²„ ì¤‘ì‹¬ì˜ ìš´ì˜ì´ ì í•©í•˜ë©°, êµ¬ê¸€ì€ ì„œí¬íŠ¸ ì±„ë„ë¡œ ì œí•œí•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•©ë‹ˆë‹¤.`;
      }
      if(seg==='ì˜ì—…íŒ€ì¥'){
        return `ë¦¬ë©¤ë²„ëŠ” CPA í‰ê·  50,000ì›ìœ¼ë¡œ ì•ˆì •ì ì¸ íš¨ìœ¨ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.  
êµ¬ê¸€ì€ CPAê°€ 60,000ì› ì´ìƒìœ¼ë¡œ ë‹¤ì†Œ ë†’ì€ í¸ì´ì—ˆìœ¼ë©° ì „í™˜ íš¨ìœ¨ì´ ë‚®ì•˜ìŠµë‹ˆë‹¤.  
ğŸ‘‰ ì˜ì—…íŒ€ì¥ì€ ë¦¬ë©¤ë²„ ì¤‘ì‹¬ìœ¼ë¡œ ì§‘í–‰í•˜ê³ , êµ¬ê¸€ì€ Awareness ìš©ë„ë¡œë§Œ í™œìš©í•˜ëŠ” ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤.`;
      }
      if(seg==='ë§ˆì¼€íŒ…íŒ€ì¥'){
        return `ë¦¬ë©¤ë²„ëŠ” CPA 52,000ì› ìˆ˜ì¤€ìœ¼ë¡œ ëª©í‘œì¹˜ì— ê·¼ì ‘í–ˆìœ¼ë©° ì „í™˜ í’ˆì§ˆì´ ìš°ìˆ˜í–ˆìŠµë‹ˆë‹¤.  
êµ¬ê¸€ì€ CPA 65,000ì› ì´ìƒìœ¼ë¡œ ë¹„ìš©ì´ ë†’ì•˜ì§€ë§Œ, íŠ¸ë˜í”½ ë³¼ë¥¨ì´ í¬ë‹¤ëŠ” ì¥ì ì´ ìˆì—ˆìŠµë‹ˆë‹¤.  
ğŸ‘‰ ë§ˆì¼€íŒ…íŒ€ì¥ì€ ë¦¬ë©¤ë²„ë¥¼ ì „í™˜ ì¤‘ì‹¬, êµ¬ê¸€ì„ í™•ì¥ í…ŒìŠ¤íŠ¸ ìš©ë„ë¡œ ë³‘í–‰í•˜ëŠ” ê²ƒì´ ì í•©í•©ë‹ˆë‹¤.`;
      }
      if(seg==='ëŒ€í‘œ'){
        return `ë¦¬ë©¤ë²„ëŠ” CPA 47,000ì› ìˆ˜ì¤€ìœ¼ë¡œ ì„¸ê·¸ë¨¼íŠ¸ ì¤‘ ê°€ì¥ íš¨ìœ¨ì ì´ì—ˆìŠµë‹ˆë‹¤.  
êµ¬ê¸€ì€ CPA 70,000ì› ì´ìƒìœ¼ë¡œ íš¨ìœ¨ì´ ë‚®ì•˜ê³  ì „í™˜ í’ˆì§ˆë„ ë¶€ì¡±í–ˆìŠµë‹ˆë‹¤.  
ğŸ‘‰ ëŒ€í‘œ ì„¸ê·¸ë¨¼íŠ¸ëŠ” ë°˜ë“œì‹œ ë¦¬ë©¤ë²„ ADID ì •ë°€ íƒ€ê²ŸíŒ…ìœ¼ë¡œ ì§‘ì¤‘ ìš´ì˜í•´ì•¼ í•˜ë©°, êµ¬ê¸€ ì˜ˆì‚°ì€ ìµœì†Œí™”ê°€ ì í•©í•©ë‹ˆë‹¤.`;
      }
      return "";
    }

    // HTML Section
    function createSectionHTML(seg) {
      return `
        <div class='section' id='section-${seg}'>
          <h2>${seg} ì„±ê³¼ ë¦¬í¬íŠ¸</h2>
          <div class='charts'>
            <div class='chart-container'><canvas id='${seg}-trend'></canvas></div>
            <div class='chart-container'><canvas id='${seg}-metric'></canvas></div>
          </div>
          <table id='${seg}-table' class='display'></table>
          <div><strong>ì¸ì‚¬ì´íŠ¸ (${seg}):</strong>
            <textarea class='insight' readonly>${makeInsight(seg)}</textarea>
          </div>
        </div>
      `;
    }
    document.getElementById('sections').innerHTML = ['ì „ì²´',...segments].map(createSectionHTML).join('');

    const trendCharts={}, metricCharts={}, dataTables={};

    function updateSection(seg){
      const labels = sampleData[seg]['ë¦¬ë©¤ë²„'].map(d=>d.period);
      // Spend Trend
      trendCharts[seg].data.labels = labels;
      trendCharts[seg].data.datasets[0].data = sampleData[seg]['ë¦¬ë©¤ë²„'].map(d=>d.spend);
      trendCharts[seg].data.datasets[1].data = sampleData[seg]['êµ¬ê¸€'].map(d=>d.spend);
      trendCharts[seg].update();
      // CPA Metric
      metricCharts[seg].data.labels = labels;
      metricCharts[seg].data.datasets[0].data = sampleData[seg]['ë¦¬ë©¤ë²„'].map(d=>d.cpa);
      metricCharts[seg].data.datasets[1].data = sampleData[seg]['êµ¬ê¸€'].map(d=>d.cpa);
      metricCharts[seg].update();
      // Table
      const rows=[];
      channels.forEach(ch=>{
        sampleData[seg][ch].forEach(r=>{
          rows.push([`${r.period} (${ch})`,r.spend.toLocaleString(),r.impr.toLocaleString(),r.clicks.toLocaleString(),r.conv.toLocaleString(),r.cpa,r.ctr,r.cvr]);
        });
      });
      const dt=dataTables[seg];
      dt.clear(); rows.forEach(r=>dt.row.add(r)); dt.draw();
    }

    document.addEventListener('DOMContentLoaded',()=>{
      ['ì „ì²´',...segments].forEach(seg=>{
        const tctx=document.getElementById(`${seg}-trend`).getContext('2d');
        trendCharts[seg]=new Chart(tctx,{
          type:'bar',
          data:{labels:[],datasets:[
            {label:'ë¦¬ë©¤ë²„ Spend',data:[],backgroundColor:'rgba(54,162,235,0.6)'},
            {label:'êµ¬ê¸€ Spend',data:[],backgroundColor:'rgba(255,159,64,0.6)'}
          ]},
          options:{responsive:true,scales:{y:{title:{display:true,text:'ê´‘ê³ ë¹„ìš©'}}}}
        });
        const mctx=document.getElementById(`${seg}-metric`).getContext('2d');
        metricCharts[seg]=new Chart(mctx,{
          type:'line',
          data:{labels:[],datasets:[
            {label:'ë¦¬ë©¤ë²„ CPA',data:[],borderColor:'rgba(54,162,235,1)',fill:false},
            {label:'êµ¬ê¸€ CPA',data:[],borderColor:'rgba(255,99,132,1)',fill:false}
          ]},
          options:{responsive:true,scales:{y:{beginAtZero:true,title:{display:true,text:'CPA'}}}}
        });
        dataTables[seg]=$(`#${seg}-table`).DataTable({
          columns:[
            {title:'ê¸°ê°„'},{title:'ê´‘ê³ ë¹„ìš©',className:'dt-right'},{title:'ë…¸ì¶œìˆ˜',className:'dt-right'},{title:'í´ë¦­ìˆ˜',className:'dt-right'},{title:'ë¦¬ë“œìˆ˜',className:'dt-right'},
            {title:'CPA',className:'dt-right'},{title:'CTR(%)',className:'dt-right'},{title:'CVR(%)',className:'dt-right'}
          ],ordering:false,paging:false,info:false,searching:false
        });
        updateSection(seg);
      });

      // íƒ­ ë„¤ë¹„ê²Œì´ì…˜
      document.querySelectorAll('.nav button').forEach(btn=>{
        btn.addEventListener('click',()=>{
          document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          const target=btn.dataset.target;
          document.querySelectorAll('.section').forEach(sec=>sec.style.display='none');
          document.getElementById(`section-${target}`).style.display='block';
        });
      });
      document.querySelector('.nav button.active').click();
    });
  </script>
</body>
</html>
